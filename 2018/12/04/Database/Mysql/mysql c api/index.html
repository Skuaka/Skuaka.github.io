

<!DOCTYPE html>
<html lang>
<head prefix="og: http://ogp.me/ns#"><meta name="generator" content="Hexo 3.8.0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <meta name="description" content>
    <title>mysql c&amp;c++ api | Hexo</title>

    <!-- Open Graph -->
    <meta name="description" content="mac os&amp;#x73AF;&amp;#x5883;Download Connector/C++https://dev.mysql.com/downloads/connector/cpp/ Header1#include &amp;lt;mysql/mysql.h&amp;gt; Compiler Arguments12345678g++ main.cpp  `mysql_config --libs`/*&amp;#x5728;">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql c&amp;c++ api">
<meta property="og:url" content="http://yoursite.com/2018/12/04/Database/Mysql/mysql c api/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="mac os&amp;#x73AF;&amp;#x5883;Download Connector/C++https://dev.mysql.com/downloads/connector/cpp/ Header1#include &amp;lt;mysql/mysql.h&amp;gt; Compiler Arguments12345678g++ main.cpp  `mysql_config --libs`/*&amp;#x5728;">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-01-31T16:32:34.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mysql c&amp;c++ api">
<meta name="twitter:description" content="mac os&amp;#x73AF;&amp;#x5883;Download Connector/C++https://dev.mysql.com/downloads/connector/cpp/ Header1#include &amp;lt;mysql/mysql.h&amp;gt; Compiler Arguments12345678g++ main.cpp  `mysql_config --libs`/*&amp;#x5728;">

    <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Person",
  "email": "mailto:",
  "image": "",
  "name": "John Doe",
  "url": "http://yoursite.com"
}
</script>
    <script>
    var algoliaEnabled = false;
    
</script>

    

    
    
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
    
    
    
        <!-- stylesheets list from config.yml -->
        
        <link rel="stylesheet" href="/css/aloha.css">
        
        <link rel="stylesheet" href="//cdn.bootcss.com/semantic-ui/2.2.4/semantic.min.css">
        
        <link rel="stylesheet" href="//cdn.bootcss.com/magnific-popup.js/1.1.0/magnific-popup.min.css">
        
    

</head>
<body id="body" style="margin-bottom: 0;" class="pushable">

    <div class="ui top fixed menu">
        <a class="item" id="menu-icon"><i class="sidebar icon"></i></a>
    </div>

    <div id="menu-sidebar" class="ui left vertical sidebar menu">

    <div id="sidebar-top">
        <div class="content">
            <h3>Hexo</h3>
        </div>
    </div>
    <div class="ui container sidebar-card">
    <div class="ui people shape content">
        <div class="active side">
            <div class="ui card">
                <div class="image">
                    <img class="ui medium bordered image" src="/images/avatar.jpg">
                </div>
                <div class="content">
                    <a class="header">John Doe</a>
                    
                </div>
                <div class="extra content">
                    <div class="ui list">
                        
                        
                    </div>

                </div>
                <div class="extra content">
                    <div class="ui list">
                        
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>

    
    

    

    
    <a href="/index.html" class="item">
        <i class="home icon"></i>
        HOME
    </a>

    

    
</div>

    <div class="pusher body-content">
        <div id="content" class="ui main container">
            <!--<div class="ui one column grid">-->
                <!--<div class="column">-->
                    <!--<div class="ui main container">-->
                        <div id="post-Database/Mysql/mysql c api" class="ui main container article-type-post">

    

    <div class="ui divided grid">

        <div class="two column row" id="article-content">

            <div class="thirteen wide computer thirteen wide tablet sixteen wide mobile column">
                

<h1 class="ui header">
    
    mysql c&amp;c++ api
</h1>



                <div class="article-inner">

                    <div class="article-entry" itemprop="articleBody">
                        
                        <h2 id="mac-os&#x73AF;&#x5883;"><a href="#mac-os&#x73AF;&#x5883;" class="headerlink" title="mac os&#x73AF;&#x5883;"></a>mac os&#x73AF;&#x5883;</h2><h3 id="Download-Connector-C"><a href="#Download-Connector-C" class="headerlink" title="Download Connector/C++"></a>Download Connector/C++</h3><p><a href="https://dev.mysql.com/downloads/connector/cpp/" target="_blank" rel="noopener">https://dev.mysql.com/downloads/connector/cpp/</a></p>
<h3 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;mysql/mysql.h&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Compiler-Arguments"><a href="#Compiler-Arguments" class="headerlink" title="Compiler Arguments"></a>Compiler Arguments</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">g++ main.cpp  `mysql_config --libs`</span><br><span class="line"><span class="comment">/*&#x5728;unix&#x73AF;&#x5883;&#x4E2D;&#x53CD;&#x5F15;&#x53F7; `` &#x548C; $() &#x90FD;&#x662F;&#x547D;&#x4EE4;&#x66FF;&#x6362;&#x3002;</span></span><br><span class="line"><span class="comment">&#x5728;&#x672C;&#x673A;(Mac)&#x4E0A;&#x76F4;&#x63A5;&#x8F93;&#x5165; mysql_config --libs &#x4EA7;&#x751F;&#x7684;&#x7ED3;&#x679C;&#x662F;: </span></span><br><span class="line"><span class="comment">-L/usr/local/Cellar/mysql/5.7.21/lib -lmysqlclient -lssl -lcrypto</span></span><br><span class="line"><span class="comment">&#x6240;&#x4EE5;&#x7B49;&#x4E8E;&#x662F;&#x53C2;&#x6570;&#x76F4;&#x63A5;&#x66FF;&#x6362;&#x4E3A;&#x540E;&#x8005;&#xFF0C;&#x4E24;&#x8005;&#x662F;&#x76F8;&#x540C;&#x6548;&#x679C;&#x3002;</span></span><br><span class="line"><span class="comment">&#x540C;&#x7406; mysql_config --cflags</span></span><br><span class="line"><span class="comment">-I/usr/local/Cellar/mysql/5.7.21/include</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p>&#x6CE8;&#xFF1A;18.9.30&#x66F4;&#x65B0;macOS Mojave &#x540E;&#xFF0C;&#x7F16;&#x8BD1;&#x9009;&#x9879;&#x62A5;&#x9519;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x53EA;&#x7528;&#x4E86; -lmysqlclient &#xFF0C;&#x628A; -lssl -lcrypto &#x5220;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x672A;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#x3002;</p>
<p>Clion &#x53EA;&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x4E24;&#x53E5;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set(CMAKE_C_FLAGS &quot;${CMAKE_C_FLAGS} -I/usr/local/Cellar/mysql/5.7.21/include&quot;)</span><br><span class="line"></span><br><span class="line">add_executable(Project01 main.c)</span><br><span class="line"></span><br><span class="line">target_link_libraries(Project01 -L/usr/local/Cellar/mysql/5.7.21/lib -lmysqlclient)</span><br></pre></td></tr></table></figure>
<h3 id="Use-in-Program"><a href="#Use-in-Program" class="headerlink" title="Use in Program"></a>Use in Program</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">//&#x8FDE;&#x63A5;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x6210;&#x529F;&#x8FD4;&#x56DE;0</span><br><span class="line">int connectMysql(MYSQL * mysql){</span><br><span class="line">    int     ret = 0;</span><br><span class="line">    MYSQL   *con = NULL;</span><br><span class="line"></span><br><span class="line">    con = mysql_init(mysql);</span><br><span class="line">    if (con == NULL) {</span><br><span class="line">        ret = mysql_errno(mysql);</span><br><span class="line">        printf(&quot;func mysql_init() err :%d\n&quot;, ret);</span><br><span class="line">        return ret;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    //&#x8FDE;&#x63A5;mysql&#x670D;&#x52A1;&#x5668;</span><br><span class="line">    //MYSQL *mysql_real_connect(MYSQL *mysql, const char *host, const char *user, const char *passwd,</span><br><span class="line">    //const char *db, unsigned int port, const char *unix_socket, unsigned long client_flag) ;</span><br><span class="line">    con = mysql_real_connect(mysql, MYSQLHOST, MYSQLUSR, MYSQLPAS, MYSQLDB, 0, NULL, 0 );</span><br><span class="line">    if (con == NULL) {</span><br><span class="line">        ret = mysql_errno(mysql);</span><br><span class="line">        printf(&quot;func mysql_real_connect() err :%d\n&quot;, ret);</span><br><span class="line">        return ret;</span><br><span class="line">    }</span><br><span class="line">#ifdef NOTDEFMYSQL</span><br><span class="line">    else {</span><br><span class="line">        printf(&quot;func mysql_real_connect() ok\n&quot;);</span><br><span class="line">    }</span><br><span class="line">#endif</span><br><span class="line">    return 0;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">/*&#x63D2;&#x5165;&#x540D;&#x5B57;&#x548C;&#x5BC6;&#x7801;&#xFF0C;&#x6210;&#x529F;&#x5219;&#x8FD4;&#x56DE;0*/</span><br><span class="line">int insertNamePass(MYSQL* mysql, const char* name, const char* pass){</span><br><span class="line">    char query[51 + MAXNAME + MAXPASS] = &quot;insert into users(username,password) values(\&quot;&quot;;</span><br><span class="line">    strncat(query, name, MAXNAME);</span><br><span class="line">    strcat(query, &quot;\&quot;,\&quot;&quot;);</span><br><span class="line">    strncat(query, pass, MAXPASS);</span><br><span class="line">    strcat(query, &quot;\&quot;)&quot;);</span><br><span class="line"></span><br><span class="line">    return mysql_real_query(mysql, query, (unsigned int)strlen(query));</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">/*&#x5982;&#x679C;&#x540D;&#x5B57;&#x5B58;&#x5728;&#x5219;&#x8FD4;&#x56DE;0*/</span><br><span class="line">int hasName(MYSQL* mysql, const char * name){</span><br><span class="line">    char query[38 + MAXNAME] = &quot;SELECT 1 FROM users WHERE username=\&quot;&quot;;</span><br><span class="line">    strncat(query, name, MAXNAME);</span><br><span class="line">    strcat(query, &quot;\&quot;&quot;);</span><br><span class="line"></span><br><span class="line">    if (mysql_real_query(mysql, query, (unsigned int)strlen(query) ) )</span><br><span class="line">    {</span><br><span class="line">        puts(&quot;MySQL query is error!&quot;);</span><br><span class="line">    }</span><br><span class="line">    else{</span><br><span class="line">        MYSQL_RES *result = mysql_store_result(mysql);</span><br><span class="line">        if( mysql_num_rows(result) ){</span><br><span class="line">            mysql_free_result(result);</span><br><span class="line">            return 0;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    return -1;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">//&#x68C0;&#x6D4B;&#x7528;&#x6237;&#x7684;&#x5BC6;&#x7801;&#x662F;&#x5426;&#x5339;&#x914D;&#xFF0C;&#x5339;&#x914D;&#x5219;&#x8FD4;&#x56DE;0</span><br><span class="line">int passRight(MYSQL* mysql, const char * name, const char * pass){</span><br><span class="line">    char query[45 + MAXNAME] = &quot;select password from users where username=\&quot;&quot;;</span><br><span class="line">    strncat(query, name, MAXNAME);</span><br><span class="line">    strcat(query, &quot;\&quot;&quot;);</span><br><span class="line"></span><br><span class="line">    if (mysql_real_query(mysql, query, (unsigned int)strlen(query) ) )</span><br><span class="line">    {</span><br><span class="line">        puts(&quot;MySQL query is error!&quot;);</span><br><span class="line">    }</span><br><span class="line">    else{</span><br><span class="line">        MYSQL_RES *result = mysql_store_result(mysql);</span><br><span class="line">        MYSQL_ROW row = mysql_fetch_row(result);</span><br><span class="line">        if( !strncmp(row[0], pass, MAXPASS)){</span><br><span class="line">            mysql_free_result(result);</span><br><span class="line">            return 0;</span><br><span class="line">        }</span><br><span class="line">        mysql_free_result(result);</span><br><span class="line">    }</span><br><span class="line">    return -1;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">//&#x8FD4;&#x56DE;&#x7528;&#x6237;&#x5206;&#x6570;,2 Bytes</span><br><span class="line">short getGrade(MYSQL* mysql, const char * name){</span><br><span class="line">    char query[42 + MAXNAME] = &quot;select grade from users where username=\&quot;&quot;;</span><br><span class="line">    strncat(query, name, MAXNAME);</span><br><span class="line">    strcat(query, &quot;\&quot;&quot;);</span><br><span class="line"></span><br><span class="line">    if (mysql_real_query(mysql, query, (unsigned int)strlen(query) ) )</span><br><span class="line">    {</span><br><span class="line">        puts(&quot;MySQL query is error!&quot;);</span><br><span class="line">    }</span><br><span class="line">    else{</span><br><span class="line">        MYSQL_RES *result = mysql_store_result(mysql);</span><br><span class="line">        MYSQL_ROW row = mysql_fetch_row(result);</span><br><span class="line">        short grade = (short)strtol(row[0], NULL, 10);</span><br><span class="line">        mysql_free_result(result);</span><br><span class="line">        return grade;</span><br><span class="line">    }</span><br><span class="line">    return -1;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h1 id="&#x5F85;&#x7EED;"><a href="#&#x5F85;&#x7EED;" class="headerlink" title="&#x5F85;&#x7EED;"></a>&#x5F85;&#x7EED;</h1>
                        
                    </div>

                    
                    
                    

                    <div class="description post-description">
    <span class="post-description-item">
        <time datetime="2018-12-04T14:18:56.000Z" itemprop="datePublished">2018-12-04</time>

    </span>
    <span class="post-description-item">
        
    </span>
</div>

                </div>
                
                <div id="pagination" class="nav-web ui text container pagination">

    <div class="ui stackable two column divided grid container">
        <div class="row">
            <div class="column nav-left">
                

                <a href="/2018/12/06/Database/SQLserver/远程登入sqlserver/" class="ui tiny button">

                    <i class="angle left icon"></i>
                    
                    远程登入 SQL server
                    

                </a>

                
            </div>
            <div class="column nav-right">
                

                <a href="/2018/12/04/Database/Mysql/mac 使用 mysql/" class="ui tiny button">
                    
                    mac 使用 mysql
                    
                    <i class="angle right icon"></i></a>
                
            </div>
        </div>
    </div>

</div>
                
            </div>

            
            <div class="three wide computer three wide tablet column">

                <div class="ui sticky article-toc" id="article-toc">
                    <!-- toc -->
                    <ol class="ui ordered list"><li><a href="#mac-os环境"><span>mac os环境</span></a><ol><li><a href="#Download-Connector-C"><span>Download Connector/C++</span></a></li><li><a href="#Header"><span>Header</span></a></li><li><a href="#Compiler-Arguments"><span>Compiler Arguments</span></a></li><li><a href="#Use-in-Program"><span>Use in Program</span></a></li></ol></li></ol><li><a href="#待续"><span>待续</span></a>
                </li></div>

            </div>
            

        </div>
    </div>
</div>


                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
        </div>
        <div class="ui vertical footer segment">
    <div class="ui center aligned container">
        <div class="ui inverted section divider"></div>
        &copy; 2019 <a href="/">John Doe</a>,
        Powered by <a href="https://github.com/henryhuang/hexo-theme-aloha" target="_blank">Aloha</a> and <a href="http://hexo.io/" target="_blank">Hexo</a>.
    </div>
</div>

    </div>




<!-- scripts list from theme config.yml -->

<script src="//cdn.bootcss.com/jquery/3.1.0/jquery.min.js"></script>

<script src="//cdn.bootcss.com/semantic-ui/2.2.4/semantic.min.js"></script>

<script src="//cdn.bootcss.com/algoliasearch/3.18.1/algoliasearch.min.js"></script>

<script src="//cdn.bootcss.com/algoliasearch-helper-js/2.13.0/algoliasearch.helper.min.js"></script>

<script src="/js/semantic-ui-algolia.js"></script>

<script src="/js/aloha-events.js"></script>



</body>
</html>
