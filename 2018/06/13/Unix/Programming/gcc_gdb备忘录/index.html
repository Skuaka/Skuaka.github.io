<!DOCTYPE html>
<html lang="zh-cmn-Hans">
  <head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  <meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
  <meta http-equiv="”Cache-Control”" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  
  <title>gcc_gdb备忘录 | Skuaka</title>
  <link rel="icon" type="image/png" sizes="32x32" href>
  



<link rel="stylesheet" href="/./vendor.ec1199.css"><link rel="stylesheet" href="/./app.5ed5af.css">


</head>
  <body>
    <header class="main-header">
  <div class="container">
    <a href="/" " class="logo">
      <img src="logo.jpg" alt="Skuaka" class="logo-img">
    </a>
    <span class="nav-separator"></span>
    <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索文章"><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
    <a href="javascript:void(0);" class="nav-icon">
      <i class="fas fa-bars"></i>
    </a>
    <nav class="main-nav">
      <ul class="nav-list">
        
          <li class="nav-link ">
            <a href="/">首页</a>
          </li>
        
          <li class="nav-link ">
            <a href="/archives/">归档</a>
          </li>
        
          <li class="nav-link ">
            <a href="/categories">分类</a>
          </li>
        
          <li class="nav-link ">
            <a href="/about.html">关于</a>
          </li>
        
      </ul>
    </nav>
  </div>
</header>
    <div class="page--article">
  
    <div class="toc-container">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#gcc常用标签"><span class="toc-number">1.</span> <span class="toc-text">gcc常用标签</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#include区别"><span class="toc-number">1.1.</span> <span class="toc-text">include区别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#静态库和动态库"><span class="toc-number">1.2.</span> <span class="toc-text">静态库和动态库</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gdb"><span class="toc-number">2.</span> <span class="toc-text">gdb</span></a></li></ol>
      <div class="toc-tip">Table of Contents ▼</div>
    </div>
  


  <div class="container">
    <article>
      <h1>gcc_gdb备忘录</h1>
      <h3 id="gcc常用标签"><a href="#gcc常用标签" class="headerlink" title="gcc常用标签"></a>gcc常用标签</h3><p><code>gcc -o hello hello.c</code>   编译；-o 后接可执行文件名称</p>
<p><code>gcc -E hello.c &gt; hello.i</code>  只进行<strong>预处理</strong></p>
<p><code>gcc hello.c -DMAX=100</code>       -D从<strong>外部定义一个宏</strong></p>
<p><code>gcc hello.c -Ilib/include</code>   -I定义第三方include路径</p>
<p><code>-Wall</code> 打开所有警告</p>
<p><code>-w</code> 关闭所有警告</p>
<p><code>-lm</code>  找数学库 <code>/usr/lib/libm.a</code></p>
<p><code>gcc -O1 -S hello.c</code>   -S 产生<strong>汇编</strong>代码 hello.s ；-O1是程序优化等级，O2优化比O1高，查看汇编代码时使用低优化等级有助于阅读学习，高版本gcc可以使用-Og</p>
<p><code>gcc -O1 -c hello.c</code> 编译并汇编，产生<strong>二进制目标代码文件</strong>hello.o ，二进制文件无法直接查看，要查看可以使用反汇编器</p>
<p><code>objdump -d hello.o</code> <strong>反汇编</strong>二进制代码并输出</p>
<p><code>gcc -c bill.c</code> -c 阻止编译器创建一个完整的程序，如果没有定义main函数却试图创建一个完整的程序不会成功，会产生一个a.out文件；如果使用了-c则产生无法运行的.o二进制文件。可以<strong>链接</strong>到其他文件。</p>
<p><code>TIMEFORMAT=&quot;&quot; time program</code> 使用time命令查看运行时间和cpu占用率。使用TIMEFORMAT重置默认的POSIX时间输出格式，POSIX时间格式不包括cpu使用率。</p>
<h4 id="include区别"><a href="#include区别" class="headerlink" title="include区别"></a>include区别</h4><p>&lt;&gt; 搜索路径是系统指定的路径</p>
<p>“ ” 先在当前路径找，再找系统路径</p>
<h4 id="静态库和动态库"><a href="#静态库和动态库" class="headerlink" title="静态库和动态库"></a>静态库和动态库</h4><p>静态库.a 动态库.so</p>
<p>/lib/ 系统运行库</p>
<p>/usr/lib/ 程序运行库</p>
<p>静态库在编译阶段加载，升级时要重新编译，容易部署(空间利用率)</p>
<p>动态库在执行阶段加载，升级不需要重新编译，不易部署</p>
<p><strong>生成静态库</strong> </p>
<ol>
<li><code>ar rcs libadd.a add.o</code></li>
<li><code>gcc main.c -ladd -L.</code></li>
</ol>
<ul>
<li><p>参数r：在库中插入模块(替换)。当插入的模块名已经在库中存在，则替换同名的模块。如果若干模块中有一个模块在库中不存在，ar显示一个错误消息，并不替换其他同名模块。默认的情况下，新的成员增加在库的结尾处，可以使用其他任选项来改变增加的位置。</p>
</li>
<li><p>参数c：创建一个库。不管库是否存在，都将创建。</p>
</li>
<li><p>参数s：创建目标文件索引，这在创建较大的库时能加快时间。</p>
</li>
</ul>
<p><strong>生成动态库</strong></p>
<p><code>gcc -shared -fPIC add.c -o libadd.so</code></p>
<ul>
<li><code>-fPIC</code> 作用于编译阶段，告诉编译器产生与位置无关代码(Position-Independent Code)，则产生的代码中，没有绝对地址，全部使用相对地址，故而代码可以被加载器加载到内存的任意位置，都可以正确的执行。这正是共享库所要求的，共享库被加载时，在内存的位置不是固定的。</li>
</ul>
<h3 id="gdb"><a href="#gdb" class="headerlink" title="gdb"></a>gdb</h3><ol>
<li>运行程序</li>
<li>设置断点</li>
<li>查看变量状态</li>
</ol>
<ol>
<li><code>gcc -g demo.c -o demo</code></li>
<li><code>gdb demo</code></li>
</ol>
<p>list  显示c代码</p>
<hr>
<p>break 10 if i=10（设置断点行号和条件）</p>
<p>break add（运行到add函数时停止）</p>
<p>info break（查看断点信息）</p>
<p>delete 1（删除断点，delete加断点编号）</p>
<p>run</p>
<p>print i（打印变量值）</p>
<p>continue(跳过当前断点继续执行)</p>
<p>quit</p>
<hr>
<p>next 单步调试，但不能进入子函数</p>
<p>step 也是单步调试，可以进入子函数</p>
<hr>
<p>所有命令都可以用首字母代替</p>
<p>info break = i b</p>
<hr>
<p>程序错误：</p>
<p>1语法错误、2逻辑错误、3运行时错误：内存错误（段错误）+ 总线错误</p>
<p>段错误可以 run 出来。</p>

  </article>
    
  </div>
</div>

    <footer class="main-footer">
  <div class="container">
    © 2018 
  </div>
</footer>
    



<script src="/./runtime.32f029.js"></script><script src="/./vendor.ec1199.js"></script><script src="/./app.5ed5af.js"></script>


  </body>
</html>
